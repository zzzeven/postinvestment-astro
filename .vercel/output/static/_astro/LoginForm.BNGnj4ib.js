import{c as y,j as e,a as j,b as g,d as N,u as b,C,e as S,f as k,g as L,h as P,I as x,B as D}from"./use-toast.DWCV5Vtc.js";import{r as o}from"./index.Cq7c7tEH.js";/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],h=y("lock",E);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],R=y("user",M);var $=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],I=$.reduce((t,s)=>{const a=j(`Primitive.${s}`),r=o.forwardRef((m,i)=>{const{asChild:d,...n}=m,u=d?a:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(u,{...n,ref:i})});return r.displayName=`Primitive.${s}`,{...t,[s]:r}},{}),T="Label",v=o.forwardRef((t,s)=>e.jsx(I.label,{...t,ref:s,onMouseDown:a=>{a.target.closest("button, input, select, textarea")||(t.onMouseDown?.(a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));v.displayName=T;var w=v;const _=N("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),p=o.forwardRef(({className:t,...s},a)=>e.jsx(w,{ref:a,className:g(_(),t),...s}));p.displayName=w.displayName;function B({onLoginSuccess:t}){const[s,a]=o.useState(""),[r,m]=o.useState(""),[i,d]=o.useState(!1),{toast:n}=b(),u=async l=>{if(l.preventDefault(),!s||!r){n({title:"错误",description:"请输入用户名和密码",variant:"destructive"});return}d(!0);try{const c=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,password:r})}),f=await c.json();if(c.ok)n({title:"登录成功",description:`欢迎回来，${f.user.username}`}),window.location.href="/";else throw new Error(f.error||"登录失败")}catch(c){n({title:"登录失败",description:c instanceof Error?c.message:"未知错误",variant:"destructive"})}finally{d(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 p-4",children:e.jsxs(C,{className:"w-full max-w-md",children:[e.jsxs(S,{className:"space-y-1 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:e.jsx(h,{className:"h-8 w-8 text-primary"})})}),e.jsx(k,{className:"text-2xl",children:"投后文档管理系统"}),e.jsx(L,{children:"请登录以继续"})]}),e.jsx(P,{children:e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"username",children:"用户名"}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(x,{id:"username",type:"text",value:s,onChange:l=>a(l.target.value),placeholder:"请输入用户名",className:"pl-9",disabled:i})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"password",children:"密码"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(x,{id:"password",type:"password",value:r,onChange:l=>m(l.target.value),placeholder:"请输入密码",className:"pl-9",disabled:i})]})]}),e.jsx(D,{type:"submit",className:"w-full",disabled:i,children:i?"登录中...":"登录"})]})})]})})}export{B as default};
